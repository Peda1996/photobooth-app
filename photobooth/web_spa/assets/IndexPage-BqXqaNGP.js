import{n as E,p as N,q as $,s as B,d as T,_ as k,t as y,v,e as n,f as c,x as d,l as a,k as u,y as P,z as _,A as f,F as A,B as x,j as p,Q as C,m as s,C as b,D as h,E as F,g as L,h as Q,G as w,r as M,H as D}from"./index-DyBYTJ4X.js";import{Q as S}from"./QPageSticky-BIdSSEX9.js";import{Q as z}from"./QPage-Df3VR9X2.js";import{Q as G}from"./QCircularProgress-DCqy4ls7.js";import"./format-CJebrXOQ.js";const H='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',R=E({name:"QSpinnerGrid",props:N,setup(e){const{cSize:t,classes:i}=$(e);return()=>B("svg",{class:i.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:H})}}),j='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',q=E({name:"QSpinnerPuff",props:N,setup(e){const{cSize:t,classes:i}=$(e);return()=>B("svg",{class:i.value,stroke:"currentColor",width:t.value,height:t.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:j})}}),V=T({name:"CountdownTimer",props:{duration:{type:Number,required:!0},messageDuration:{type:Number,default:.5},messageText:{type:String,default:"ðŸ˜ƒ"}},data(){return{intervalTimerId:null,remainingSeconds:0,startDuration:0}},computed:{showBox(){return this.remainingSeconds>0},showCountdown(){return this.remainingSeconds>0},showMessage(){return+this.remainingSeconds<=this.messageDuration}},mounted(){this.startTimer()},beforeUnmount(){clearInterval(this.intervalTimerId)},methods:{abortTimer(){clearInterval(this.intervalTimerId),this.remainingSeconds=0},startTimer(){this.startDuration=this.duration,this.remainingSeconds=this.startDuration,console.log(`starting timer, duration=${this.startDuration}`),this.intervalTimerId=window.setInterval(()=>{this.remainingSeconds-=.05,this.remainingSeconds<=0&&clearInterval(this.intervalTimerId)},50)}}}),O={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},K=["innerHTML"],X={style:{height:"100%"}};function U(e,t,i,r,l,m){return y((n(),c("div",O,[y(d("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:e.messageText},null,8,K),[[v,e.showMessage]]),d("div",X,[y(a(G,{"show-value":!e.showMessage,style:{width:"100%",height:"100%"},value:e.remainingSeconds,min:0,max:e.startDuration,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:u(()=>[P(_(parseFloat(e.remainingSeconds.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[v,e.showCountdown]])])],512)),[[v,e.showBox]])}const Y=k(V,[["render",U],["__file","CountdownTimer.vue"]]),J=T({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(e,{expose:t,emit:i}){t();const r=i;function l(o,g){r("triggerAction",o,g)}const m={emit:r,triggerButtonClick:l,get isEmpty(){return f.isEmpty}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),W={class:"row q-gutter-md action-buttons"},Z={style:{"white-space":"nowrap"},class:"gt-sm"};function ee(e,t,i,r,l,m){return n(),c("div",W,[(n(!0),c(A,null,x(i.triggers,(o,g)=>(n(),c("div",{key:g},[o.show_button&&!(r.isEmpty(o.title)&&r.isEmpty(o.icon))?(n(),p(h,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:b(["action-button col-auto",["action-button-"+g]]),onClick:I=>r.triggerButtonClick(o.action,o.config_index)},{default:u(()=>[r.isEmpty(o.icon)?s("",!0):(n(),p(C,{key:0,name:`sym_o_${o.icon}`},null,8,["name"])),d("div",Z,_(o.title),1)]),_:2},1032,["class","onClick"])):s("",!0)]))),128))])}const te=k(J,[["render",ee],["__file","FrontpageTriggerButtons.vue"]]),ie=T({components:{CountdownTimer:Y,FrontpageTriggerButtons:te},setup(){const e=F(),t=L(),i=Q();return{store:e,stateStore:t,configurationStore:i,remoteProcedureCall:w}},computed:{triggerButtons(){const e=[];return["actions.image","actions.collage","actions.animation","actions.video","actions.multicamera","printer.print"].forEach(i=>{this.configurationStore.getConfigElement(i,[]).forEach((l,m)=>{const o={action:i.replace(".","/"),config_index:m,show_button:f.get(l,"trigger.ui_trigger.show_button",!1),title:f.get(l,"trigger.ui_trigger.title",""),icon:f.get(l,"trigger.ui_trigger.icon","")};e.push(o)})}),console.log(e),e},showProcessing(){const e=this.stateStore.state=="capture";return this.stateStore.state=="captures_completed"||e&&!this.showCountdownCounting},showRecording(){return this.stateStore.state=="record"},livestreamMirror(){return this.configurationStore.getConfigElement("uisettings.livestream_mirror_effect")},showCountdownCounting(){const e=this.stateStore.state=="counting",t=this.stateStore.state=="capture";return this.stateStore.duration&&this.stateStore.duration>0&&e||t},showPreview(){const e=!this.stateStore.state||this.stateStore.state=="finished",t=this.stateStore.state=="record",i=this.stateStore.state=="counting",r=this.stateStore.state=="capture";return e||i||t||r},showFrontpage(){return!this.stateStore.state||this.stateStore.state=="finished"}},watch:{},methods:{invokeAction(e,t){w(`/api/${e}/${t}`)},stopRecordingVideo(){w("/api/actions/stop")}}}),ne={key:0,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},oe={key:1,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},re=["innerHTML"],se={key:0},ae={key:0},ce={class:"q-gutter-md"},le={class:"gt-sm"},ue={class:"gt-sm"};function de(e,t,i,r,l,m){const o=M("countdown-timer"),g=M("FrontpageTriggerButtons");return n(),p(z,{id:"index-page",class:"q-pa-none column full-height"},{default:u(()=>[d("div",{id:"preview-stream-wrapper",class:b({mirroreffect:e.livestreamMirror})},[e.showPreview?(n(),c("div",{key:0,id:"preview-stream",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},class:b(["full-width column justify-center content-center",{countdowncounting:e.showCountdownCounting}])},null,2)):s("",!0)],2),e.showProcessing?(n(),c("div",ne,[a(R,{size:"20em"})])):s("",!0),e.showCountdownCounting?(n(),c("div",oe,[a(o,{ref:"countdowntimer",duration:e.stateStore.duration,"message-duration":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TIME"),"message-text":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TEXT")},null,8,["duration","message-duration","message-text"])])):s("",!0),e.showFrontpage?(n(),c("div",{key:2,id:"frontpage_text",innerHTML:e.configurationStore.getConfigElement("uisettings.FRONTPAGE_TEXT")},null,8,re)):s("",!0),a(S,{position:"bottom",offset:[0,25]},{default:u(()=>[e.showFrontpage?(n(),c("div",se,[a(g,{triggers:e.triggerButtons,onTriggerAction:e.invokeAction},null,8,["triggers","onTriggerAction"])])):s("",!0)]),_:1}),a(S,{position:"top-left",offset:[25,25]},{default:u(()=>[e.showFrontpage?(n(),c("div",ae,[d("div",ce,[e.configurationStore.getConfigElement("uisettings.show_gallery_on_frontpage")?(n(),p(h,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button",style:D(e.configurationStore.getConfigElement("uisettings.gallery_button_style"))},{default:u(()=>[a(C,{left:"",name:"sym_o_photo_library"}),d("div",le,_(e.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1},8,["style"])):s("",!0),e.configurationStore.getConfigElement("uisettings.show_admin_on_frontpage")?(n(),p(h,{key:1,id:"frontpage-button-to-admin",rounded:"",color:"secondary","no-caps":"",to:"/admin",class:"action-button"},{default:u(()=>[a(C,{left:"",name:"sym_o_admin_panel_settings"}),d("div",ue,_(e.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1})):s("",!0)])])):s("",!0)]),_:1}),e.showRecording?(n(),p(S,{key:3,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:u(()=>[a(q,{color:"red",size:"10em"}),t[1]||(t[1]=d("br",null,null,-1)),a(h,{flat:"",color:"red",label:"Stop recording",onClick:t[0]||(t[0]=I=>e.stopRecordingVideo())})]),_:1})):s("",!0)]),_:1})}const _e=k(ie,[["render",de],["__file","IndexPage.vue"]]);export{_e as default};
