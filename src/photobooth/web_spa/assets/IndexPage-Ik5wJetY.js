import{s as D,t as H,v as O,x as F,d as S,y as P,e as m,z as K,o as W,A as E,B as I,f as i,g as r,C as g,n as u,m as f,D as X,E as M,F as J,G as U,p as d,H as A,l as v,Q as L,q as o,I as Q,J as T,h as Y,i as Z,a as ee,K as te,_ as z,L as G}from"./index-BNYqvihj.js";import{Q as x}from"./QPageSticky-D8tivGkn.js";import{Q as ie}from"./QPage-DE6HUUKJ.js";import{Q as ne}from"./QCircularProgress-CR8C7lC9.js";import"./format-CJebrXOQ.js";const ae='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',re=D({name:"QSpinnerGrid",props:H,setup(p){const{cSize:e,classes:t}=O(p);return()=>F("svg",{class:t.value,fill:"currentColor",width:e.value,height:e.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:ae})}}),oe='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',se=D({name:"QSpinnerPuff",props:H,setup(p){const{cSize:e,classes:t}=O(p);return()=>F("svg",{class:t.value,stroke:"currentColor",width:e.value,height:e.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:oe})}}),ce={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},le=["innerHTML"],ue={style:{height:"100%"}},me=S({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(p){let e;const t=P(0),s=P(0),l=p,y=m(()=>t.value>0),c=m(()=>t.value>0),_=m(()=>t.value<=l.messageDuration);K(()=>{b()}),W(()=>{h()});const h=()=>{clearInterval(e),t.value=0},b=()=>{s.value=l.duration,t.value=s.value,console.log(`starting timer, duration=${s.value}`),e=window.setInterval(()=>{t.value-=.05,t.value<=0&&clearInterval(e)},50)};return(B,q)=>E((i(),r("div",ce,[E(g("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:B.messageText},null,8,le),[[I,_.value]]),g("div",ue,[E(u(ne,{"show-value":!_.value,style:{width:"100%",height:"100%"},value:t.value,min:0,max:s.value,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:f(()=>[X(M(parseFloat(t.value.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[I,c.value]])])],512)),[[I,y.value]])}}),de={class:"row q-gutter-md action-buttons"},ge={style:{"white-space":"nowrap"},class:"gt-sm"},pe=S({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(p,{emit:e}){const t=e;function s(l,y){t("triggerAction",l,y)}return(l,y)=>(i(),r("div",de,[(i(!0),r(J,null,U(l.triggers,(c,_)=>(i(),r("div",{key:_},[c.show_button&&!(d(A.isEmpty)(c.title)&&d(A.isEmpty)(c.icon))?(i(),v(T,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:Q(["action-button col-auto glass-effect",["action-button-"+_]]),onClick:h=>s(c.action,c.config_index)},{default:f(()=>[d(A.isEmpty)(c.icon)?o("",!0):(i(),v(L,{key:0,name:`sym_o_${c.icon}`},null,8,["name"])),g("div",ge,M(c.title),1)]),_:2},1032,["class","onClick"])):o("",!0)]))),128))]))}}),fe={key:0,id:"preview-blurredback",style:{"background-image":"url('/api/aquisition/stream.mjpg')"}},_e={key:1,id:"overlay-wrapper"},ve=["src"],ye={key:2,id:"stream-wrapper"},he=S({__name:"PreviewStream",props:{enableMirrorEffect:{type:Boolean},enableBlurredBackgroundStream:{type:Boolean},frameOverlayImage:{}},setup(p){const e=p;return(t,s)=>(i(),r("div",{id:"preview-container",class:Q({mirroreffect:e.enableMirrorEffect})},[e.enableBlurredBackgroundStream?(i(),r("div",fe)):o("",!0),e.frameOverlayImage??!0?(i(),r("div",_e,[g("img",{id:"overlay-image",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},src:e.frameOverlayImage},null,8,ve)])):(i(),r("div",ye,s[0]||(s[0]=[g("img",{id:"stream-image",src:"/api/aquisition/stream.mjpg"},null,-1)])))],2))}}),be={key:1,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},we={key:2,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},ke=["innerHTML"],Ce={key:0},xe={key:0},Te={class:"q-gutter-md"},Me={class:"gt-sm"},Se={key:0},Be={class:"q-gutter-md"},Ne={class:"gt-sm"},Le=S({__name:"IndexPage",setup(p){const e=Y(),t=Z(),s=ee(),l=P(0);te(l,()=>{l.value>=5&&s.push("/admin"),l.value=0},{debounce:500});const y=m(()=>{const n=[];return Object.entries(t.configuration.actions).forEach(([a,C])=>{C.forEach((w,N)=>{const $={action:`actions/${a}`,config_index:N,show_button:w.trigger.ui_trigger.show_button,title:w.trigger.ui_trigger.title,icon:w.trigger.ui_trigger.icon};n.push($)})}),console.log(n),n}),c=m(()=>{const n=e.state=="capture";return e.state=="captures_completed"||n&&!b.value}),_=m(()=>e.state=="record"),h=m(()=>t.configuration.uisettings.admin_button_invisible),b=m(()=>{const n=e.state=="counting",a=e.state=="capture";return e.duration&&e.duration>0&&n||a}),B=m(()=>{if(b.value){const n=z.get(e.configuration_set,"processing.img_frame_enable",!1),a=z.get(e.configuration_set,"processing.img_frame_file","");return n?a:t.configuration.uisettings.livestream_frameoverlay_image}else return t.configuration.uisettings.enable_livestream_frameoverlay?t.configuration.uisettings.livestream_frameoverlay_image:""}),q=m(()=>{const n=t.configuration.uisettings.enable_livestream_when_idle,a=t.configuration.uisettings.enable_livestream_when_active,C=!e.state||e.state=="finished",w=e.state=="record",N=e.state=="counting",$=e.state=="capture";return C&&n||(N||$)&&a||w}),k=m(()=>!e.state||e.state=="finished"),j=()=>{h.value?l.value++:s.push("/admin")},R=(n,a)=>{G(`/api/${n}/${a}`)},V=()=>{G("/api/actions/stop")};return(n,a)=>(i(),v(ie,{id:"index-page",class:"q-pa-none column full-height"},{default:f(()=>[q.value?(i(),v(he,{key:0,"frame-overlay-image":B.value,"enable-blurred-background-stream":d(t).configuration.uisettings.livestream_blurredbackground,"enable-mirror-effect":d(t).configuration.uisettings.livestream_mirror_effect},null,8,["frame-overlay-image","enable-blurred-background-stream","enable-mirror-effect"])):o("",!0),c.value?(i(),r("div",be,[u(re,{size:"20em"})])):o("",!0),b.value?(i(),r("div",we,[u(me,{ref:"countdowntimer",duration:d(e).duration,"message-duration":d(t).configuration.uisettings.TAKEPIC_MSG_TIME,"message-text":d(t).configuration.uisettings.TAKEPIC_MSG_TEXT},null,8,["duration","message-duration","message-text"])])):o("",!0),k.value?(i(),r("div",{key:3,id:"frontpage_text",innerHTML:d(t).configuration.uisettings.FRONTPAGE_TEXT},null,8,ke)):o("",!0),u(x,{position:"bottom",class:"q-mb-lg"},{default:f(()=>[k.value?(i(),r("div",Ce,[u(pe,{triggers:y.value,onTriggerAction:R},null,8,["triggers"])])):o("",!0)]),_:1}),u(x,{position:"top-left",class:"q-ma-lg"},{default:f(()=>[k.value?(i(),r("div",xe,[g("div",Te,[d(t).configuration.uisettings.show_gallery_on_frontpage?(i(),v(T,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button glass-effect"},{default:f(()=>[u(L,{left:"",name:"sym_o_photo_library"}),g("div",Me,M(n.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1})):o("",!0)])])):o("",!0)]),_:1}),u(x,{position:"top-right",class:"q-ma-lg"},{default:f(()=>[k.value?(i(),r("div",Se,[g("div",Be,[d(t).configuration.uisettings.show_admin_on_frontpage?(i(),v(T,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:Q(["action-button action-button-admin glass-effect",{"action-button-admin-invisible":h.value}]),onClick:j},{default:f(()=>[u(L,{left:"",name:"sym_o_admin_panel_settings"}),g("div",Ne,M(n.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):o("",!0)])])):o("",!0)]),_:1}),_.value?(i(),v(x,{key:4,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:f(()=>[u(se,{color:"red",size:"10em"}),a[1]||(a[1]=g("br",null,null,-1)),u(T,{flat:"",color:"red",label:"Stop recording",onClick:a[0]||(a[0]=C=>V())})]),_:1})):o("",!0)]),_:1}))}});export{Le as default};
