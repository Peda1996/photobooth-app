import{d as v,u as b,a as k,b as C,c as B,e as w,o as M,w as h,f as m,g as N,h as Q,i as A,j as E,r as T,k as _,l as u,m as l,n as f,Q as $,p as L,q as R,t as q,s as y}from"./index-DMTCEbHD.js";import{Q as I}from"./QPageSticky-DhBmdmM2.js";import{Q as O,a as P}from"./QLayout-4rR5rd0H.js";const V=v({__name:"RouteAfterTimeout",props:{route:{type:String,required:!0},timeoutMs:{type:Number,required:!0},warningMessage:{type:String,default:"Auto-starting slideshow... Click anywhere to stay on this page."},warningTimeMs:{type:Number,default:1e4}},setup(d){const a=b(),s=k(),e=d,{idle:n,lastActive:o}=C(e.timeoutMs),t=B({interval:1e3}),i=w(()=>e.timeoutMs-(t.value-o.value)),g=w(()=>e.warningTimeMs>i.value);let c=null;function S(){c=a.notify({progress:!0,message:e.warningMessage,type:"info",multiLine:!0,timeout:i.value,icon:"sym_o_slideshow"})}function p(){c&&c()}return M(()=>{p()}),h(g,r=>{r?S():p()}),h(n,r=>{r&&(p(),s.push({path:e.route}))}),(r,W)=>(m(),N("div"))}}),H=v({__name:"MainLayout",setup(d){const a=Q(),s=A(),e=k(),n=E();return a.$subscribe((o,t)=>{t.state=="counting"&&n.path!="/"&&(console.log("counting state received, pushing to index page to countdown"),e.push("/")),t.state=="present_capture"&&e.push({name:"itempresenter",params:{id:a.last_captured_mediaitem.id}}),t.state=="approve_capture"&&t.ask_user_for_approval&&e.push({path:"/itemapproval"})}),(o,t)=>{const i=T("router-view");return m(),_(P,{id:"main-layout",view:"hHh lpR fFf"},{default:u(()=>[l(O,null,{default:u(()=>[l(i),f(n).path!="/"?(m(),_(I,{key:0,position:"top-left",class:"q-ma-lg",style:{}},{default:u(()=>[l($,{id:"layout-button-back",color:"primary",rounded:"","no-caps":"",onClick:t[0]||(t[0]=g=>o.$router.back()),class:"action-button"},{default:u(()=>[l(L,{left:"",name:"sym_o_arrow_back_ios_new"}),R("div",null,q(o.$t("BTN_LABEL_BACK")),1)]),_:1})]),_:1})):y("",!0),f(s).getConfigElement("uisettings.enable_automatic_slideshow",!1)?(m(),_(V,{key:1,route:"/slideshow/random","timeout-ms":f(s).getConfigElement("uisettings.show_automatic_slideshow_timeout",300)*1e3,"warning-message":o.$t("MSG_WARN_BEFORE_AUTO_SLIDESHOW")},null,8,["timeout-ms","warning-message"])):y("",!0)]),_:1})]),_:1})}}});export{H as default};
