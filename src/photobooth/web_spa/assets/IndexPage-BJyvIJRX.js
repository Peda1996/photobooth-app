import{f as j,g as z,h as G,i as D,d as x,j as A,k as b,l as R,m as F,n as E,v as N,p as r,o as i,q as m,e as u,w as f,s as V,t as C,F as W,x as K,c as v,y as s,z as n,A as $,Q as S,B as U,C as L,D as P,E as X,u as Y,G as J,H as Z,b as ee,_ as q,I as O}from"./index-B6xGO5uY.js";import{Q as k}from"./QPageSticky-UgxxnUpG.js";import{Q as te}from"./QPage-BChigvSo.js";import{Q as ie}from"./QCircularProgress-CMW_KlNr.js";import{_ as ne}from"./RouteAfterTimeout.vue_vue_type_script_setup_true_lang-BvDnIxWv.js";import"./format-CJebrXOQ.js";const ae='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',oe=j({name:"QSpinnerGrid",props:z,setup(d){const{cSize:a,classes:e}=G(d);return()=>D("svg",{class:e.value,fill:"currentColor",width:a.value,height:a.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:ae})}}),se='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',re=j({name:"QSpinnerPuff",props:z,setup(d){const{cSize:a,classes:e}=G(d);return()=>D("svg",{class:e.value,stroke:"currentColor",width:a.value,height:a.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:se})}}),le={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},ce=["innerHTML"],ue={style:{height:"100%"}},me=x({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(d){let a;const e=A(0),t=A(0),g=d,_=b(()=>e.value>0),o=b(()=>e.value>0),p=b(()=>e.value<=g.messageDuration);R(()=>{T()}),F(()=>{h()});const h=()=>{clearInterval(a),e.value=0},T=()=>{t.value=g.duration,e.value=t.value,console.log(`starting timer, duration=${t.value}`),a=window.setInterval(()=>{e.value-=.05,e.value<=0&&clearInterval(a)},50)};return(M,Q)=>E((i(),r("div",le,[E(m("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:M.messageText},null,8,ce),[[N,p.value]]),m("div",ue,[E(u(ie,{"show-value":!p.value,style:{width:"100%",height:"100%"},value:e.value,min:0,max:t.value,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:f(()=>[V(C(parseFloat(e.value.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[N,o.value]])])],512)),[[N,_.value]])}}),de={class:"row q-gutter-md action-buttons"},ge={style:{"white-space":"nowrap"},class:"gt-sm"},_e=x({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(d,{emit:a}){const e=a;function t(g,_){e("triggerAction",g,_)}return(g,_)=>(i(),r("div",de,[(i(!0),r(W,null,K(g.triggers,(o,p)=>(i(),r("div",{key:p},[o.show_button&&!(n($.isEmpty)(o.title)&&n($.isEmpty)(o.icon))?(i(),v(S,{key:0,stack:"",color:o.use_custom_color?"custom":"primary","no-caps":"",rounded:"",class:L(["action-button col-auto glass-effect",["action-button-"+p]]),style:U({"--bg-custom":o.use_custom_color?o.custom_color:null}),onClick:h=>t(o.action,o.config_index)},{default:f(()=>[n($.isEmpty)(o.icon)?s("",!0):(i(),v(P,{key:0,name:`sym_o_${o.icon}`},null,8,["name"])),m("div",ge,C(o.title),1)]),_:2},1032,["color","class","style","onClick"])):s("",!0)]))),128))]))}}),fe={key:0,id:"preview-blurredback",style:{"background-image":"url('/api/aquisition/stream.mjpg')"}},pe={key:1,id:"overlay-wrapper"},ve=["src"],ye={key:2,id:"stream-wrapper"},be=x({__name:"PreviewStream",props:{enableMirrorEffect:{type:Boolean},enableBlurredBackgroundStream:{type:Boolean},frameOverlayImage:{}},setup(d){const a=d;return(e,t)=>(i(),r("div",{id:"preview-container",class:L({mirroreffect:a.enableMirrorEffect})},[a.enableBlurredBackgroundStream?(i(),r("div",fe)):s("",!0),a.frameOverlayImage??!0?(i(),r("div",pe,[m("img",{id:"overlay-image",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},src:a.frameOverlayImage},null,8,ve)])):(i(),r("div",ye,t[0]||(t[0]=[m("img",{id:"stream-image",src:"/api/aquisition/stream.mjpg"},null,-1)])))],2))}}),he={key:1,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},we={key:2,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},ke=["innerHTML"],Se={key:0},Ce={key:0},xe={class:"q-gutter-md"},Te={class:"gt-sm"},Me={key:0},Be={class:"q-gutter-md"},Ie={class:"gt-sm"},Qe=x({__name:"IndexPage",setup(d){const a=X(),e=Y(),t=J(),g=ee(),_=A(0);Z(_,()=>{_.value>=5&&g.push("/admin"),_.value=0},{debounce:500});const o=b(()=>{const l=[];return Object.entries(t.configuration.actions).forEach(([c,w])=>{w.forEach((y,B)=>{const I={action:`actions/${c}`,config_index:B,show_button:y.trigger.ui_trigger.show_button,title:y.trigger.ui_trigger.title,icon:y.trigger.ui_trigger.icon,use_custom_color:y.trigger.ui_trigger.use_custom_color,custom_color:y.trigger.ui_trigger.custom_color};l.push(I)})}),console.log(l),l}),p=b(()=>t.configuration.uisettings.admin_button_invisible),h=b(()=>{const l=t.configuration.uisettings.enable_livestream_when_idle,c=t.configuration.uisettings.enable_livestream_when_active,w=e.isStateIdle,y=e.isStateRecording,B=e.isStateCountdown,I=e.isStateCapture;return w&&l||(B||I)&&c||y}),T=b(()=>{if(e.isStateCountdown){const l=q.get(e.jobmodel.configuration_set,"processing.img_frame_enable",!1),c=q.get(e.jobmodel.configuration_set,"processing.img_frame_file","");return l?c:t.configuration.uisettings.livestream_frameoverlay_image}else return t.configuration.uisettings.enable_livestream_frameoverlay?t.configuration.uisettings.livestream_frameoverlay_image:""}),M=()=>{p.value?_.value++:g.push("/admin")},Q=(l,c)=>{O(`/api/${l}/${c}`)},H=()=>{O("/api/processing/next")};return(l,c)=>(i(),v(te,{id:"index-page",class:"q-pa-none column full-height"},{default:f(()=>[h.value?(i(),v(be,{key:0,"frame-overlay-image":T.value,"enable-blurred-background-stream":n(t).configuration.uisettings.livestream_blurredbackground,"enable-mirror-effect":n(t).configuration.uisettings.livestream_mirror_effect},null,8,["frame-overlay-image","enable-blurred-background-stream","enable-mirror-effect"])):s("",!0),n(e).isStateProcessing?(i(),r("div",he,[u(oe,{size:"20em"})])):s("",!0),n(e).isStateCountdown?(i(),r("div",we,[u(me,{ref:"countdowntimer",duration:n(e).jobmodel.duration,"message-duration":n(t).configuration.uisettings.TAKEPIC_MSG_TIME,"message-text":n(t).configuration.uisettings.TAKEPIC_MSG_TEXT},null,8,["duration","message-duration","message-text"])])):s("",!0),n(e).isStateIdle?(i(),r("div",{key:3,id:"frontpage_text",innerHTML:n(t).configuration.uisettings.FRONTPAGE_TEXT},null,8,ke)):s("",!0),u(k,{position:"bottom",class:"q-mb-lg"},{default:f(()=>[n(e).isStateIdle?(i(),r("div",Se,[u(_e,{triggers:o.value,onTriggerAction:Q},null,8,["triggers"])])):s("",!0)]),_:1}),u(k,{position:"top-left",class:"q-ma-lg"},{default:f(()=>[n(e).isStateIdle?(i(),r("div",Ce,[m("div",xe,[n(t).configuration.uisettings.show_gallery_on_frontpage?(i(),v(S,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button glass-effect"},{default:f(()=>[u(P,{left:"",name:"sym_o_photo_library"}),m("div",Te,C(l.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1})):s("",!0)])])):s("",!0)]),_:1}),u(k,{position:"top-right",class:"q-ma-lg"},{default:f(()=>[n(e).isStateIdle?(i(),r("div",Me,[m("div",Be,[n(t).configuration.uisettings.show_admin_on_frontpage?(i(),v(S,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:L(["action-button action-button-admin glass-effect",{"action-button-admin-invisible":p.value}]),onClick:M},{default:f(()=>[u(P,{left:"",name:"sym_o_admin_panel_settings"}),m("div",Ie,C(l.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):s("",!0)])])):s("",!0)]),_:1}),n(e).isStateRecording?(i(),v(k,{key:4,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:f(()=>[u(re,{color:"red",size:"10em"}),c[1]||(c[1]=m("br",null,null,-1)),u(S,{flat:"",color:"red",label:"Stop recording",onClick:c[0]||(c[0]=w=>H())})]),_:1})):s("",!0),n(t).configuration.uisettings.enable_automatic_slideshow&&n(a).collection_number_of_items>0?(i(),v(ne,{key:5,route:"/slideshow/random","timeout-ms":n(t).configuration.uisettings.show_automatic_slideshow_timeout*1e3,"warning-message":l.$t("MSG_WARN_BEFORE_AUTO_SLIDESHOW")},null,8,["timeout-ms","warning-message"])):s("",!0)]),_:1}))}});export{Qe as default};
