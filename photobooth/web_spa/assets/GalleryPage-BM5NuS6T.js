import{Q as k,G as y}from"./GalleryImageDetail-G0vvryvV.js";import{S as P,T as C,t as q,r as b,U as S,f as m,x as h,O as B,V as G,W as E,_ as M,j as Q,c as l,k as p,l as g,d as c,F as V,G as j,m as f,B as _,X as L,Y as T,L as N,s as O,R as F}from"./index-fve9Nqks.js";import{Q as H}from"./QPage-CqAbde4Y.js";import"./QHeader-r5wcg7Ak.js";import"./QLayout-DjfBVtNR.js";import"./QLinearProgress-D2Gn-eOa.js";import"./use-panel-B-IorhyV.js";import"./QMenu-BfzjpSzd.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-C0xoTVFS.js";import"./QPageSticky-CYQQ0pAV.js";import"./QBtnDropdown-DdyyvpGI.js";import"./use-id-DWk68ZT2.js";const I={threshold:0,root:null,rootMargin:"0px"};function D(e,t,i){let o,s,n;typeof i=="function"?(o=i,s=I,n=t.cfg===void 0):(o=i.handler,s=Object.assign({},I,i.cfg),n=t.cfg===void 0||C(t.cfg,s)===!1),t.handler!==o&&(t.handler=o),n===!0&&(t.cfg=s,t.observer!==void 0&&t.observer.unobserve(e),t.observer=new IntersectionObserver(([a])=>{if(typeof t.handler=="function"){if(a.rootBounds===null&&document.body.contains(e)===!0){t.observer.unobserve(e),t.observer.observe(e);return}(t.handler(a,t.observer)===!1||t.once===!0&&a.isIntersecting===!0)&&w(e)}},s),t.observer.observe(e))}function w(e){const t=e.__qvisible;t!==void 0&&(t.observer!==void 0&&t.observer.unobserve(e),delete e.__qvisible)}const R=P({name:"intersection",mounted(e,{modifiers:t,value:i}){const o={once:t.once===!0};D(e,o,i),e.__qvisible=o},updated(e,t){const i=e.__qvisible;i!==void 0&&D(e,i,t.value)},beforeUnmount:w}),U=q({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(e,{slots:t,emit:i}){const o=b(S.value===!0?e.ssrPrerender:!1),s=m(()=>e.root!==void 0||e.margin!==void 0||e.threshold!==void 0?{handler:d,cfg:{root:e.root,rootMargin:e.margin,threshold:e.threshold}}:d),n=m(()=>e.disable!==!0&&(S.value!==!0||e.once!==!0||e.ssrPrerender!==!0)),a=m(()=>[[R,s.value,void 0,{once:e.once}]]),r=m(()=>`--q-transition-duration: ${e.transitionDuration}ms`);function d(u){o.value!==u.isIntersecting&&(o.value=u.isIntersecting,e.onVisibility!==void 0&&i("visibility",o.value))}function v(){if(o.value===!0)return[h("div",{key:"content",style:r.value},B(t.default))];if(t.hidden!==void 0)return[h("div",{key:"hidden",style:r.value},t.hidden())]}return()=>{const u=e.transition?[h(G,{name:"q-transition--"+e.transition},v)]:v();return E(e.tag,{class:"q-intersection"},u,"main",n.value,()=>a.value)}}}),Y={components:{GalleryImageDetail:y},setup(){const e=N(),t=O(),i=F();return{store:e,configurationStore:t,mediacollectionStore:i,GalleryImageDetail:y,indexSelected:b(null),showImageDetail:b(!1)}},computed:{itemId(){return this.$route.params.id},isGalleryEmpty(){return this.mediacollectionStore.collection_number_of_items==0}},watch:{itemId(e){const t=this.mediacollectionStore.getIndexOfItemId(e);t==-1?console.error(`image id not found ${e}`):this.openPic(t)}},mounted(){},methods:{getImageDetail(e,t="thumbnail"){return this.mediacollectionStore.collection[e][t]},openPic(e){this.indexSelected=e,this.showImageDetail=!0}}},A={key:0,class:"row justify-center q-gutter-sm"},x={key:0},z={key:1},W={class:"absolute-full"},X=["src"],J=["innerHTML"];function K(e,t,i,o,s,n){const a=Q("gallery-image-detail");return l(),p(H,{id:"gallery-page",padding:""},{default:g(()=>[n.isGalleryEmpty?(l(),c("div",{key:1,innerHTML:o.configurationStore.getConfigElement("uisettings.GALLERY_EMPTY_MSG")},null,8,J)):(l(),c("div",A,[(l(!0),c(V,null,j(o.mediacollectionStore.collection,(r,d)=>(l(),p(U,{key:r.id,once:"",class:"preview-item"},{default:g(()=>[f(L,{class:"q-ma-xs no-shadow",onClick:v=>n.openPic(d)},{default:g(()=>[r.media_type!="video"?(l(),c("div",x,[f(k,{src:n.getImageDetail(d),loading:"eager","no-transition":"","no-spinner":"",ratio:1,class:"rounded-borders"},null,8,["src"])])):(l(),c("div",z,[t[2]||(t[2]=_("div",{style:{"padding-bottom":"100%"}},null,-1)),_("div",W,[_("video",{style:{width:"100%",height:"100%","object-fit":"cover","object-position":"50% 50%"},autoplay:"",loop:"",muted:"",playsinline:"",src:n.getImageDetail(d),class:"rounded-borders"},null,8,X)])]))]),_:2},1032,["onClick"])]),_:2},1024))),128))])),f(T,{modelValue:o.showImageDetail,"onUpdate:modelValue":t[1]||(t[1]=r=>o.showImageDetail=r),"transition-show":"jump-up","transition-hide":"jump-down",maximized:""},{default:g(()=>[f(a,{"item-repository":o.mediacollectionStore.collection,"index-selected":o.indexSelected,class:"full-height",onCloseEvent:t[0]||(t[0]=r=>o.showImageDetail=!1)},null,8,["item-repository","index-selected"])]),_:1},8,["modelValue"])]),_:1})}const ue=M(Y,[["render",K],["__scopeId","data-v-056b5c3b"],["__file","GalleryPage.vue"]]);export{ue as default};
