import{s as H,v as R,x as j,y as q,d as I,z as G,e as d,A as O,o as K,_ as L,B as E,C as B,f as i,g as m,p as _,m as u,l as p,D as W,t as T,E as x,F as X,G as J,k as v,n as P,q as l,H as A,Q as S,h as U,i as Y,I as D,J as Z}from"./index-CJvLDmP-.js";import{Q as N}from"./QPageSticky-B8ofIUpv.js";import{Q as $}from"./QPage-MfmOlYcX.js";import{Q as ee}from"./QCircularProgress-68djVKVI.js";import"./format-CJebrXOQ.js";const te='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',ne=H({name:"QSpinnerGrid",props:R,setup(r){const{cSize:n,classes:t}=j(r);return()=>q("svg",{class:t.value,fill:"currentColor",width:n.value,height:n.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:te})}}),ie='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',oe=H({name:"QSpinnerPuff",props:R,setup(r){const{cSize:n,classes:t}=j(r);return()=>q("svg",{class:t.value,stroke:"currentColor",width:n.value,height:n.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:ie})}}),re=I({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(r,{expose:n}){n();let t;const e=G(0),a=G(0),s=r,o=d(()=>e.value>0),g=d(()=>e.value>0),h=d(()=>e.value<=s.messageDuration);O(()=>{C()}),K(()=>{w()});const w=()=>{clearInterval(t),e.value=0},C=()=>{a.value=s.duration,e.value=a.value,console.log(`starting timer, duration=${a.value}`),t=window.setInterval(()=>{e.value-=.05,e.value<=0&&clearInterval(t)},50)},k={get intervalTimerId(){return t},set intervalTimerId(F){t=F},remainingSeconds:e,startDuration:a,props:s,showBox:o,showCountdown:g,showMessage:h,abortTimer:w,startTimer:C};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),ae={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},se=["innerHTML"],ce={style:{height:"100%"}};function le(r,n,t,e,a,s){return E((i(),m("div",ae,[E(_("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:t.messageText},null,8,se),[[B,e.showMessage]]),_("div",ce,[E(u(ee,{"show-value":!e.showMessage,style:{width:"100%",height:"100%"},value:e.remainingSeconds,min:0,max:e.startDuration,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:p(()=>[W(T(parseFloat(e.remainingSeconds.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[B,e.showCountdown]])])],512)),[[B,e.showBox]])}const ue=L(re,[["render",le],["__file","CountdownTimer.vue"]]),de=I({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(r,{expose:n,emit:t}){n();const e=t;function a(o,g){e("triggerAction",o,g)}const s={emit:e,triggerButtonClick:a,get isEmpty(){return x.isEmpty}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),me={class:"row q-gutter-md action-buttons"},ge={style:{"white-space":"nowrap"},class:"gt-sm"};function pe(r,n,t,e,a,s){return i(),m("div",me,[(i(!0),m(X,null,J(t.triggers,(o,g)=>(i(),m("div",{key:g},[o.show_button&&!(e.isEmpty(o.title)&&e.isEmpty(o.icon))?(i(),v(S,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:A(["action-button col-auto",["action-button-"+g]]),onClick:h=>e.triggerButtonClick(o.action,o.config_index)},{default:p(()=>[e.isEmpty(o.icon)?l("",!0):(i(),v(P,{key:0,name:`sym_o_${o.icon}`},null,8,["name"])),_("div",ge,T(o.title),1)]),_:2},1032,["class","onClick"])):l("",!0)]))),128))])}const _e=L(de,[["render",pe],["__file","FrontpageTriggerButtons.vue"]]),fe=I({__name:"IndexPage",setup(r,{expose:n}){n();const t=U(),e=Y(),a=d(()=>{const c=[];return["actions.image","actions.collage","actions.animation","actions.video","actions.multicamera","printer.print"].forEach(b=>{e.getConfigElement(b,[]).forEach((y,M)=>{const V={action:b.replace(".","/"),config_index:M,show_button:x.get(y,"trigger.ui_trigger.show_button",!1),title:x.get(y,"trigger.ui_trigger.title",""),icon:x.get(y,"trigger.ui_trigger.icon","")};c.push(V)})}),console.log(c),c}),s=d(()=>{const c=t.state=="capture";return t.state=="captures_completed"||c&&!h.value}),o=d(()=>t.state=="record"),g=d(()=>e.getConfigElement("uisettings.livestream_mirror_effect")),h=d(()=>{const c=t.state=="counting",f=t.state=="capture";return t.duration&&t.duration>0&&c||f}),w=d(()=>{const c=e.getConfigElement("uisettings.enable_livestream_when_idle",!0),f=e.getConfigElement("uisettings.enable_livestream_when_active",!0),b=!t.state||t.state=="finished",z=t.state=="record",y=t.state=="counting",M=t.state=="capture";return b&&c||(y||M)&&f||z}),C=d(()=>!t.state||t.state=="finished"),Q={stateStore:t,configurationStore:e,triggerButtons:a,showProcessing:s,showRecording:o,livestreamMirror:g,showCountdownCounting:h,showPreview:w,showFrontpage:C,invokeAction:(c,f)=>{D(`/api/${c}/${f}`)},stopRecordingVideo:()=>{D("/api/actions/stop")},CountdownTimer:ue,FrontpageTriggerButtons:_e};return Object.defineProperty(Q,"__isScriptSetup",{enumerable:!1,value:!0}),Q}}),ve={key:0,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},he={key:1,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},ye=["innerHTML"],we={key:0},Ce={key:0},be={class:"q-gutter-md"},xe={class:"gt-sm"},Se={class:"gt-sm"};function Te(r,n,t,e,a,s){return i(),v($,{id:"index-page",class:"q-pa-none column full-height"},{default:p(()=>[_("div",{id:"preview-stream-wrapper",class:A({mirroreffect:e.livestreamMirror})},[e.showPreview?(i(),m("div",{key:0,id:"preview-stream",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},class:A(["full-width column justify-center content-center",{countdowncounting:e.showCountdownCounting}])},null,2)):l("",!0)],2),e.showProcessing?(i(),m("div",ve,[u(ne,{size:"20em"})])):l("",!0),e.showCountdownCounting?(i(),m("div",he,[u(e.CountdownTimer,{ref:"countdowntimer",duration:e.stateStore.duration,"message-duration":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TIME"),"message-text":e.configurationStore.getConfigElement("uisettings.TAKEPIC_MSG_TEXT")},null,8,["duration","message-duration","message-text"])])):l("",!0),e.showFrontpage?(i(),m("div",{key:2,id:"frontpage_text",innerHTML:e.configurationStore.getConfigElement("uisettings.FRONTPAGE_TEXT")},null,8,ye)):l("",!0),u(N,{position:"bottom",class:"q-mb-lg"},{default:p(()=>[e.showFrontpage?(i(),m("div",we,[u(e.FrontpageTriggerButtons,{triggers:e.triggerButtons,onTriggerAction:e.invokeAction},null,8,["triggers"])])):l("",!0)]),_:1}),u(N,{position:"top-left",class:"q-ma-lg"},{default:p(()=>[e.showFrontpage?(i(),m("div",Ce,[_("div",be,[e.configurationStore.getConfigElement("uisettings.show_gallery_on_frontpage")?(i(),v(S,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button",style:Z(e.configurationStore.getConfigElement("uisettings.gallery_button_style"))},{default:p(()=>[u(P,{left:"",name:"sym_o_photo_library"}),_("div",xe,T(r.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1},8,["style"])):l("",!0),e.configurationStore.getConfigElement("uisettings.show_admin_on_frontpage")?(i(),v(S,{key:1,id:"frontpage-button-to-admin",rounded:"",color:"secondary","no-caps":"",to:"/admin",class:"action-button"},{default:p(()=>[u(P,{left:"",name:"sym_o_admin_panel_settings"}),_("div",Se,T(r.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1})):l("",!0)])])):l("",!0)]),_:1}),e.showRecording?(i(),v(N,{key:3,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:p(()=>[u(oe,{color:"red",size:"10em"}),n[1]||(n[1]=_("br",null,null,-1)),u(S,{flat:"",color:"red",label:"Stop recording",onClick:n[0]||(n[0]=o=>e.stopRecordingVideo())})]),_:1})):l("",!0)]),_:1})}const Pe=L(fe,[["render",Te],["__file","IndexPage.vue"]]);export{Pe as default};
