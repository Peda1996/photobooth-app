import{Q as $,a as C}from"./QLayout-BiXYtNQ6.js";import{d as S,u as R,a as M,b as T,c as A,e as g,o as k,w as h,_ as b,f as m,g as x,h as N,i as E,j as L,r as P,k as w,l as v,m as y,n as B}from"./index-3YkxgYt2.js";const O=S({__name:"RouteAfterTimeout",props:{route:{type:String,required:!0},timeoutMs:{type:Number,required:!0},warningMessage:{type:String,default:"Auto-starting slideshow... Click anywhere to stay on this page."},warningTimeMs:{type:Number,default:1e4}},setup(r,{expose:i}){i();const o=R(),t=M(),e=r,{idle:s,lastActive:a}=T(e.timeoutMs),_=A({interval:1e3}),n=g(()=>e.timeoutMs-(_.value-a.value)),l=g(()=>e.warningTimeMs>n.value);let u=null;function f(){u=o.notify({progress:!0,message:e.warningMessage,type:"info",multiLine:!0,timeout:n.value,icon:"sym_o_slideshow"})}function p(){u&&u()}k(()=>{p()}),h(l,c=>{c?f():p()}),h(s,c=>{c&&(p(),t.push({path:e.route}))});const d={$q:o,router:t,props:e,idle:s,lastActive:a,now:_,remainingTime:n,showWarning:l,get warningPopup(){return u},set warningPopup(c){u=c},showNotification:f,hideNotification:p};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}});function Q(r,i,o,t,e,s){return m(),x("div")}const j=b(O,[["render",Q],["__file","RouteAfterTimeout.vue"]]),q=S({__name:"MainLayout",setup(r,{expose:i}){i();const o=N(),t=E(),e=M(),s=L();o.$subscribe((_,n)=>{n.state=="counting"&&s.path!="/"&&(console.log("counting state received, pushing to index page to countdown"),e.push("/")),n.state=="present_capture"&&e.push({name:"itempresenter",params:{id:o.last_captured_mediaitem.id}}),n.state=="approve_capture"&&n.ask_user_for_approval&&e.push({path:"/itemapproval"})});const a={stateStore:o,configurationStore:t,router:e,route:s,RouteAfterTimeout:j};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}});function W(r,i,o,t,e,s){const a=P("router-view");return m(),w(C,{id:"main-layout",view:"hHh lpR fFf"},{default:v(()=>[y($,null,{default:v(()=>[y(a),t.configurationStore.getConfigElement("uisettings.enable_automatic_slideshow",!1)?(m(),w(t.RouteAfterTimeout,{key:0,route:"/slideshow/random","timeout-ms":t.configurationStore.getConfigElement("uisettings.show_automatic_slideshow_timeout",300)*1e3,"warning-message":r.$t("MSG_WARN_BEFORE_AUTO_SLIDESHOW")},null,8,["timeout-ms","warning-message"])):B("",!0)]),_:1})]),_:1})}const I=b(q,[["render",W],["__file","MainLayout.vue"]]);export{I as default};
